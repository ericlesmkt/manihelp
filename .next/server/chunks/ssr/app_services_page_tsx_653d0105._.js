module.exports=[47326,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(7291),f=a.i(33508),g=a.i(26017),h=a.i(90166),i=a.i(41710);let j=(0,a.i(70106).default)("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);var k=a.i(41961);function l({isOpen:a,onClose:d,service:l,onSave:m}){let[n,o]=(0,c.useState)({name:"",price:"",duration:"",description:""}),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null);if((0,c.useEffect)(()=>{l&&(o({name:l.name,price:l.price.toFixed(2).replace(".",","),duration:l.duration.toString(),description:l.description||""}),s(null))},[l]),!a||!l)return null;let t=a=>{let{name:b,value:c}=a.target;o(a=>({...a,[b]:c}))},u=async a=>{if(a.preventDefault(),!l)return;let b=parseFloat(n.price.replace(",",".")),c=parseInt(n.duration,10);if(!n.name||isNaN(b)||isNaN(c)||c<=0)return void s("Por favor, preencha nome, preço e duração (em minutos) corretamente.");q(!0),s(null);try{let{error:a}=await e.supabase.from("services").update({name:n.name,price:b,duration_minutes:c,description:n.description.trim()}).eq("id",l.id);if(a)throw Error(a.message);m(),d()}catch(a){s("Erro ao salvar serviço: "+a.message),console.error(a)}finally{q(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",onClick:d,children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"p-5 border-b flex justify-between items-center sticky top-0 bg-white rounded-t-xl",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold text-mani-pink-600",children:["Editar Serviço: ",l.name]}),(0,b.jsx)("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full transition",children:(0,b.jsx)(f.X,{className:"w-6 h-6"})})]}),(0,b.jsxs)("form",{onSubmit:u,className:"p-5 space-y-4",children:[r&&(0,b.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded-lg text-sm",children:r}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Serviço"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Briefcase,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,b.jsx)("input",{type:"text",id:"name",name:"name",value:n.name,onChange:t,required:!0,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500",placeholder:"Ex: Manicure Simples"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-1",children:"Preço (R$)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(h.DollarSign,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,b.jsx)("input",{type:"text",id:"price",name:"price",value:n.price,onChange:a=>{let b=a.target.value;b=(b=b.replace(/[^\d.,]/g,"")).replace(",","."),o(a=>({...a,price:b}))},required:!0,inputMode:"decimal",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500",placeholder:"Ex: 35,00"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700 mb-1",children:"Duração (minutos)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(i.Clock,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,b.jsx)("input",{type:"number",id:"duration",name:"duration",value:n.duration,onChange:t,required:!0,min:"5",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500",placeholder:"Ex: 45"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição (Opcional)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),(0,b.jsx)("textarea",{id:"description",name:"description",value:n.description,onChange:t,rows:3,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500 resize-none",placeholder:"O que o serviço inclui? (Ex: Esfoliação e hidratação)"})]})]}),(0,b.jsx)("button",{type:"submit",disabled:p,className:"w-full py-2 px-4 bg-mani-pink-600 text-white font-semibold rounded-lg shadow-md hover:bg-mani-pink-700 transition disabled:opacity-50 flex items-center justify-center",children:p?(0,b.jsx)(g.Loader2,{className:"w-5 h-5 animate-spin mr-2"}):"Salvar Alterações"})]})]})})}var m=a.i(81560),n=a.i(15618),o=a.i(60246),p=a.i(41675),q=a.i(55225),r=a.i(43108),s=a.i(23312),t=a.i(5784),u=a.i(20005),v=a.i(21161),w=a.i(99464);function x({user:a}){let f=(0,d.useRouter)(),[g,h]=(0,c.useState)(!1),[j,l]=(0,c.useState)(a.name),m=async()=>{let{error:a}=await e.supabase.auth.signOut();a||f.replace("/")};return(0,c.useEffect)(()=>{!async function(){let{data:{user:a}}=await e.supabase.auth.getUser();if(!a)return;let{data:b}=await e.supabase.from("profiles").select("name").eq("id",a.id).single();b&&l(b.name)}()},[]),(0,b.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-mani-pink-600",children:"ManiHelp"}),(0,b.jsxs)("nav",{className:"hidden md:flex space-x-6",children:[(0,b.jsxs)("a",{href:"/dashboard",className:"font-medium px-1 py-2 text-sm transition text-gray-500 hover:text-gray-700",children:[(0,b.jsx)(p.Calendar,{className:"inline-block w-5 h-5 mr-1"}),"Agenda"]}),(0,b.jsxs)("a",{href:"/clients",className:"font-medium px-1 py-2 text-sm transition text-gray-500 hover:text-gray-700",children:[(0,b.jsx)(o.Users,{className:"inline-block w-5 h-5 mr-1"}),"Clientes"]}),(0,b.jsxs)("a",{href:"/services",className:"font-medium px-1 py-2 text-sm transition text-gray-500 hover:text-gray-700",children:[(0,b.jsx)(k.Briefcase,{className:"inline-block w-5 h-5 mr-1"}),"Serviços"]}),(0,b.jsxs)("a",{href:"/schedules",className:"font-medium px-1 py-2 text-sm transition text-gray-500 hover:text-gray-700",children:[(0,b.jsx)(i.Clock,{className:"inline-block w-5 h-5 mr-1"}),"Horários"]}),(0,b.jsxs)("a",{href:"#",className:"font-medium px-1 py-2 text-sm transition text-gray-400 cursor-not-allowed",title:"Recurso em desenvolvimento",children:[(0,b.jsx)(q.BarChart3,{className:"inline-block w-5 h-5 mr-1"}),(0,b.jsx)(r.Lock,{className:"inline-block w-4 h-4 mr-1"}),"Relatórios"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("button",{className:"text-gray-400 hover:text-gray-500 rounded-full p-1 relative",children:[(0,b.jsx)(s.Bell,{className:"w-6 h-6"}),(0,b.jsx)("span",{className:"absolute top-0 right-0 block h-2 w-2 rounded-full bg-mani-pink-500 ring-2 ring-white"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("button",{onClick:()=>h(!g),className:"flex items-center space-x-2 rounded-full p-1 pr-2 hover:bg-gray-100",children:[(0,b.jsx)("span",{className:"hidden sm:inline font-medium text-sm text-gray-700",children:j}),(0,b.jsx)(t.ChevronDown,{className:`w-4 h-4 text-gray-500 transition-transform ${g?"rotate-180":""}`})]}),g&&(0,b.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl py-1 ring-1 ring-black ring-opacity-5 z-20",children:[(0,b.jsxs)("a",{href:"#",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,b.jsx)(v.Settings,{className:"inline-block w-4 h-4 mr-2"}),"Configurações"]}),(0,b.jsxs)("button",{onClick:m,className:"w-full text-left block px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,b.jsx)(u.LogOut,{className:"inline-block w-4 h-4 mr-2"}),"Sair"]})]})]})]})]})})})}function y(){let a=(0,d.useRouter)(),[f,j]=(0,c.useState)(null),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[y,z]=(0,c.useState)({name:"",price:"",duration:"60",description:""}),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),E=(0,c.useCallback)(async a=>{v(null);try{let{data:b,error:c}=await e.supabase.from("services").select("id, name, price, duration_minutes, description").eq("manicure_id",a).order("name",{ascending:!0});if(c)throw Error(c.message);let d=(b||[]).map(a=>({id:a.id,name:a.name,price:a.price,duration:a.duration_minutes,description:a.description||""}));p(d)}catch(a){v("Falha ao carregar serviços: "+a.message),console.error(a)}},[]);(0,c.useEffect)(()=>{!async function(){let{data:{user:b}}=await e.supabase.auth.getUser();if(!b)return a.replace("/");let{data:c,error:d}=await e.supabase.from("profiles").select("id, name, role").eq("id",b.id).single();if(d||c?.role!=="manicure"){await e.supabase.auth.signOut(),a.replace("/");return}j({id:c.id,name:c.name}),await E(b.id),r(!1)}();let{data:{subscription:b}}=e.supabase.auth.onAuthStateChange(b=>{"SIGNED_OUT"===b&&a.replace("/")});return()=>b.unsubscribe()},[a,E]);let F=async a=>{if(a.preventDefault(),t(!0),v(null),!f||!y.name||!y.price||!y.duration){v("Preencha nome, preço e duração."),t(!1);return}let b=parseFloat(y.price.replace(",",".")),c=parseInt(y.duration,10);if(isNaN(b)||isNaN(c)||c<=0){v("Preço ou duração inválidos."),t(!1);return}let d={manicure_id:f.id,name:y.name.trim(),price:b,duration_minutes:c,description:y.description.trim()};try{let{error:a}=await e.supabase.from("services").insert([d]);if(a){if("23505"===a.code)throw Error("Você já tem um serviço com este nome.");throw Error(a.message)}z({name:"",price:"",duration:"60",description:""}),E(f.id)}catch(a){v(a.message)}finally{t(!1)}},G=async a=>{if(f&&confirm("Tem certeza que deseja excluir este serviço? Esta ação é irreversível.")){t(!0),v(null);try{let{error:b}=await e.supabase.from("services").delete().eq("id",a);if(b)throw Error(b.message);E(f.id)}catch(a){v(a.message)}finally{t(!1)}}},H=()=>{B(!1),D(null),f&&E(f.id)},I=a=>{let{name:b,value:c}=a.target;z(a=>({...a,[b]:c}))};return q||!f?(0,b.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:[(0,b.jsx)(g.Loader2,{className:"w-8 h-8 text-mani-pink-600 animate-spin"}),(0,b.jsx)("p",{className:"ml-3 text-gray-600",children:"Carregando serviços..."})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-100 font-inter",children:[(0,b.jsx)(x,{user:{name:"Dona Maria",avatarUrl:"https://placehold.co/100x100/E62E7A/FFFFFF?text=M"}}),(0,b.jsx)(l,{isOpen:A,onClose:H,service:C,onSave:H}),(0,b.jsxs)("main",{className:"max-w-4xl mx-auto py-6 sm:py-10 px-4 sm:px-6 lg:px-8",children:[(0,b.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,b.jsx)(k.Briefcase,{className:"w-7 h-7 mr-3 text-mani-pink-600"}),"Catálogo de Serviços"]}),(0,b.jsx)("p",{className:"text-lg text-gray-600 mt-1",children:"Gerencie os serviços que você oferece e seus respectivos preços e durações."})]}),u&&(0,b.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded-lg mb-6 text-sm",children:u}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-8",children:[(0,b.jsxs)("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[(0,b.jsx)(n.Plus,{className:"w-5 h-5 mr-2"}),"Novo Serviço"]}),(0,b.jsxs)("form",{onSubmit:F,className:"grid grid-cols-2 md:grid-cols-4 gap-4 items-end",children:[(0,b.jsxs)("div",{className:"col-span-2 md:col-span-4 lg:col-span-1",children:[(0,b.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nome"}),(0,b.jsx)("input",{type:"text",id:"name",name:"name",value:y.name,onChange:I,required:!0,placeholder:"Manicure Simples",className:"mt-1 w-full py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Preço (R$)"}),(0,b.jsx)("input",{type:"text",id:"price",name:"price",value:y.price,onChange:a=>{let b=a.target.value;b=(b=b.replace(/[^\d.,]/g,"")).replace(",","."),z(a=>({...a,price:b}))},required:!0,inputMode:"decimal",className:"mt-1 w-full py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500",placeholder:"35,00"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duração (min)"}),(0,b.jsx)("input",{type:"number",id:"duration",name:"duration",value:y.duration,onChange:I,required:!0,min:"5",className:"mt-1 w-full py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500",placeholder:"45"})]}),(0,b.jsx)("div",{className:"col-span-2 md:col-span-1",children:(0,b.jsx)("button",{type:"submit",disabled:s,className:"w-full py-2 px-4 bg-mani-pink-600 text-white font-semibold rounded-lg shadow-md hover:bg-mani-pink-700 transition disabled:opacity-50 flex items-center justify-center h-[42px]",children:s?(0,b.jsx)(g.Loader2,{className:"w-5 h-5 animate-spin"}):"Adicionar"})}),(0,b.jsxs)("div",{className:"col-span-2 md:col-span-4",children:[(0,b.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Descrição (Opcional)"}),(0,b.jsx)("textarea",{id:"description",name:"description",value:y.description,onChange:I,rows:2,className:"mt-1 w-full py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:ring-mani-pink-500 focus:border-mani-pink-500 resize-none",placeholder:"Detalhes do serviço para seus clientes (Ex: Incluso esfoliação)."})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Seu Catálogo Atual"}),0===o.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Nenhum serviço cadastrado. Adicione um acima!"}):(0,b.jsx)("ul",{className:"divide-y divide-gray-100",children:o.map(a=>(0,b.jsxs)("li",{className:"py-4 flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1 pr-4",children:[(0,b.jsx)("div",{className:"font-bold text-lg text-gray-900 flex items-center mb-1",children:a.name}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:space-x-4 text-sm text-gray-600",children:[(0,b.jsxs)("p",{className:"flex items-center",children:[(0,b.jsx)(h.DollarSign,{className:"w-4 h-4 mr-1 text-green-600"}),"R$ ",a.price.toFixed(2).replace(".",",")]}),(0,b.jsxs)("p",{className:"flex items-center mt-1 sm:mt-0",children:[(0,b.jsx)(i.Clock,{className:"w-4 h-4 mr-1 text-indigo-600"}),a.duration," min"]})]}),a.description&&(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-2 italic border-l-2 pl-2 border-mani-pink-200",children:a.description})]}),(0,b.jsxs)("div",{className:"flex space-x-2 flex-shrink-0",children:[(0,b.jsx)("button",{onClick:()=>{D(a),B(!0)},disabled:s,className:"text-mani-pink-600 hover:text-mani-pink-800 disabled:text-gray-400 p-2 transition rounded-lg hover:bg-mani-pink-50",title:"Editar Serviço",children:(0,b.jsx)(w.Pencil,{className:"w-5 h-5"})}),(0,b.jsx)("button",{onClick:()=>G(a.id),disabled:s,className:"text-red-500 hover:text-red-700 disabled:text-gray-400 p-2 transition rounded-lg hover:bg-red-50",title:"Excluir Serviço",children:(0,b.jsx)(m.Trash2,{className:"w-5 h-5"})})]})]},a.id))})]})]})]})}a.s(["default",()=>y],47326)}];

//# sourceMappingURL=app_services_page_tsx_653d0105._.js.map