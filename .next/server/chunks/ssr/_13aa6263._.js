module.exports=[41675,60246,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);a.s(["Calendar",()=>c],41675);let d=(0,b.default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);a.s(["Users",()=>d],60246)},20005,a=>{"use strict";let b=(0,a.i(70106).default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);a.s(["LogOut",()=>b],20005)},21161,a=>{"use strict";let b=(0,a.i(70106).default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Settings",()=>b],21161)},27999,a=>{"use strict";let b=(0,a.i(70106).default)("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);a.s(["CalendarCheck",()=>b],27999)},41710,a=>{"use strict";let b=(0,a.i(70106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],41710)},33441,a=>{"use strict";let b=(0,a.i(70106).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);a.s(["Check",()=>b],33441)},49370,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(70106);let e=(0,d.default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var f=a.i(27999),g=a.i(41710),h=a.i(46842);let i=(0,d.default)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);var j=a.i(63519),k=a.i(26017),l=a.i(60246),m=a.i(7291);let n={client_id:"",service_id:"",start_time:"",manicure_id:"",newClientName:"",newClientPhone:""};function o({isOpen:a,onClose:d,manicureId:o,onAppointmentCreated:q}){let[r,s]=(0,c.useState)({...n,manicure_id:o}),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)("existing"),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),F=(0,c.useCallback)(async()=>{A(!0),C(null);try{let{data:a,error:b}=await m.supabase.from("profiles").select("id, name").eq("role","client").order("name",{ascending:!0}),{data:c,error:d}=await m.supabase.from("services").select("id, name, price, duration_minutes").eq("manicure_id",o);if(b||d)throw Error(b?.message||d?.message);u(a||[]),w(c||[])}catch(a){console.error("Erro ao carregar dados:",a),C("Falha ao carregar clientes ou serviços. Verifique a conexão com o Supabase e RLS.")}finally{A(!1)}},[o]),G=async(a,b)=>{let c=crypto.randomUUID(),{data:d,error:e}=await m.supabase.from("profiles").insert({id:c,name:a,phone_number:b,role:"client"}).select("id").single();if(e)throw Error(`Falha ao criar novo cliente: ${e.message}`);return d.id};(0,c.useEffect)(()=>{a&&(F(),y("existing"),s({...n,manicure_id:o}))},[a,F,o]);let H=a=>{let{name:b,value:c}=a.target;s(a=>({...a,[b]:c}))},I=async a=>{a.preventDefault(),E(!0),C(null);let b=r.client_id;try{if("new"===x){if(!r.newClientName||!r.newClientPhone){C("Nome e Telefone são obrigatórios para novos clientes."),E(!1);return}b=await G(r.newClientName,r.newClientPhone)}if(!b||!r.service_id||!r.start_time){C("Por favor, preencha todos os campos obrigatórios."),E(!1);return}let a=Number(r.service_id),c=v.find(b=>b.id===a);if(!c||isNaN(a)){C("Serviço inválido ou não selecionado."),E(!1);return}let e=new Date(r.start_time),f=new Date(e.getTime()+6e4*c.duration_minutes),g={client_id:b,manicure_id:r.manicure_id,service_id:a,start_time:e.toISOString(),end_time:f.toISOString(),status:"pending"},{error:h}=await m.supabase.from("appointments").insert([g]);if(h)throw Error(h.message);q(),d()}catch(a){console.error("Erro ao salvar agendamento:",a),C(`Falha ao salvar. Detalhe: ${a.message}`)}finally{E(!1)}};return a?(0,b.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 transition-opacity duration-300",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4 transform transition-all duration-300 scale-100",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[(0,b.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,b.jsx)(f.CalendarCheck,{className:"w-6 h-6 mr-2 text-mani-pink-600"}),"Novo Agendamento"]}),(0,b.jsx)("button",{onClick:d,className:"p-2 rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition",children:(0,b.jsx)(e,{className:"w-6 h-6"})})]}),(0,b.jsxs)("form",{onSubmit:I,className:"p-6 space-y-6",children:[B&&(0,b.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded-md text-sm",role:"alert",children:(0,b.jsx)("p",{children:B})}),(0,b.jsxs)("div",{className:"space-y-3 border-b border-gray-200 pb-4",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center mb-1",children:[(0,b.jsx)(l.Users,{className:"w-4 h-4 mr-1 text-mani-pink-600"}),"Opções de Cliente"]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>y("existing"),className:`flex-1 px-4 py-2 text-sm font-semibold rounded-lg transition ${"existing"===x?"bg-mani-pink-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Cliente Existente"}),(0,b.jsx)("button",{type:"button",onClick:()=>y("new"),className:`flex-1 px-4 py-2 text-sm font-semibold rounded-lg transition ${"new"===x?"bg-mani-pink-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Novo Cliente"})]})]}),"existing"===x&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"client_id",className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,b.jsx)(h.User,{className:"w-4 h-4 mr-1 text-mani-pink-600"}),"Selecionar Cliente"]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{id:"client_id",name:"client_id",value:r.client_id,onChange:H,disabled:z||D,className:"mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm rounded-lg shadow-sm appearance-none cursor-pointer",children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Selecione um cliente..."}),z?(0,b.jsx)("option",{disabled:!0,children:"Carregando clientes..."}):t.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,b.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:(0,b.jsx)(p,{className:"w-4 h-4 text-gray-400"})})]})]}),"new"===x&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"newClientName",className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,b.jsx)(h.User,{className:"w-4 h-4 mr-1 text-mani-pink-600"}),"Nome do Cliente"]}),(0,b.jsx)("input",{type:"text",id:"newClientName",name:"newClientName",value:r.newClientName,onChange:H,placeholder:"Nome completo do novo cliente",className:"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"newClientPhone",className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,b.jsx)(j.Phone,{className:"w-4 h-4 mr-1 text-mani-pink-600"}),"Telefone / WhatsApp"]}),(0,b.jsx)("input",{type:"tel",id:"newClientPhone",name:"newClientPhone",value:r.newClientPhone,onChange:H,placeholder:"(99) 99999-9999",className:"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm",required:!0})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"service_id",className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,b.jsx)(i,{className:"w-4 h-4 mr-1 text-mani-pink-600"}),"Serviço"]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{id:"service_id",name:"service_id",value:r.service_id,onChange:H,disabled:z||D,className:"mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm rounded-lg shadow-sm appearance-none cursor-pointer",children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Selecione um serviço..."}),z?(0,b.jsx)("option",{disabled:!0,children:"Carregando serviços..."}):v.map(a=>(0,b.jsxs)("option",{value:String(a.id),children:[a.name," (R$ ",a.price.toFixed(2)," / ",a.duration_minutes," min)"]},a.id))]}),(0,b.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:(0,b.jsx)(p,{className:"w-4 h-4 text-gray-400"})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"start_time",className:"block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,b.jsx)(g.Clock,{className:"w-4 h-4 mr-1 text-mani-pink-600"}),"Data e Hora"]}),(0,b.jsx)("input",{type:"datetime-local",id:"start_time",name:"start_time",value:r.start_time,onChange:H,disabled:D,required:!0,className:"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm"})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[(0,b.jsx)("button",{type:"button",onClick:d,disabled:D,className:"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 transition",children:"Cancelar"}),(0,b.jsx)("button",{type:"submit",disabled:D||z,className:"px-5 py-2.5 text-sm font-medium text-white bg-mani-pink-600 rounded-lg shadow-md hover:bg-mani-pink-700 transition flex items-center justify-center",children:D?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Confirmar Agendamento"})]})]})]})}):null}function p(a){return(0,b.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",...a,children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}a.s(["default",()=>o],49370)}];

//# sourceMappingURL=_13aa6263._.js.map