{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/lib/supabaseClient.ts"],"sourcesContent":["// Nome do arquivo: lib/supabaseClient.ts\nimport { createClient } from '@supabase/supabase-js';\n\n// As variáveis de ambiente são lidas do .env.local\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n// Verifica se as variáveis estão definidas\nif (!supabaseUrl || !supabaseKey) {\n  throw new Error('As variáveis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY são obrigatórias.');\n}\n\n// Cria e exporta o cliente Supabase\nexport const supabase = createClient(supabaseUrl, supabaseKey);"],"names":[],"mappings":"AAAA,yCAAyC;;;;;AACzC;;AAEA,mDAAmD;AACnD,MAAM;AACN,MAAM;AAEN,2CAA2C;AAC3C;;AAKO,MAAM,WAAW,IAAA,uMAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/components/ClientAppointments.tsx"],"sourcesContent":["// Nome do arquivo: components/ClientAppointments.tsx\n\"use client\";\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '../lib/supabaseClient';\nimport { Clock, Check, XCircle, Calendar, Loader2, AlertTriangle } from 'lucide-react';\n\n// CORREÇÃO: Tipo ServiceData agora reflete o que o Supabase retorna no JOIN\ntype ServiceData = { id: number; name: string; price: number };\n\n// --- Tipos de Agendamento (Visão do Cliente) ---\ntype ClientAppointmentItem = {\n    id: number;\n    start_time: string;\n    end_time: string;\n    status: 'pending' | 'confirmed' | 'cancelled' | 'completed';\n    // CORREÇÃO CRÍTICA: Tipado como ARRAY, mesmo que contenha apenas um item\n    service_id: ServiceData[] | null; \n};\n\ninterface ClientAppointmentsProps {\n    clientId: string;\n}\n\n// Dicionário de Status para a UI\nconst StatusDisplay = {\n    pending: { label: \"Pendente\", color: \"yellow\", icon: Clock },\n    confirmed: { label: \"Confirmado\", color: \"green\", icon: Check },\n    cancelled: { label: \"Cancelado\", color: \"red\", icon: XCircle },\n    completed: { label: \"Concluído\", color: \"gray\", icon: Calendar },\n};\n\nexport default function ClientAppointments({ clientId }: ClientAppointmentsProps) {\n    const [appointments, setAppointments] = useState<ClientAppointmentItem[]>([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [isCancelling, setIsCancelling] = useState<number | null>(null); \n\n    // Função auxiliar para acessar o nome e o preço do serviço corretamente\n    const getServiceName = (appt: ClientAppointmentItem) => appt.service_id && appt.service_id[0]?.name ? appt.service_id[0].name : 'Serviço não encontrado';\n    const getServicePrice = (appt: ClientAppointmentItem) => appt.service_id && appt.service_id[0]?.price ? `R$ ${parseFloat(String(appt.service_id[0].price)).toFixed(2)}` : 'N/A';\n\n    // Função que busca os dados e ordena\n    const fetchAndSortAppointments = useCallback(async () => {\n        setIsLoading(true);\n        setError(null);\n        try {\n            const { data, error } = await supabase\n                .from('appointments')\n                .select(`\n                    id, start_time, end_time, status,\n                    service_id (id, name, price)\n                `)\n                .eq('client_id', clientId)\n                .order('start_time', { ascending: true }); \n\n            if (error) {\n                throw new Error(error.message);\n            }\n            \n            // CORREÇÃO FINAL: Converte o array retornado para o tipo correto (array de AppointmentItem)\n            setAppointments(data as ClientAppointmentItem[]);\n\n        } catch (e: any) {\n            console.error('Erro ao buscar agendamentos:', e);\n            setError(`Falha ao buscar agendamentos. Detalhe: ${e.message}`);\n        } finally {\n            setIsLoading(false);\n        }\n    }, [clientId]);\n    \n    // NOVO: Função para Cancelar Agendamento\n    const handleCancel = async (id: number) => {\n        setIsCancelling(id);\n        setError(null);\n\n        try {\n            // Atualiza o status no Supabase\n            const { error: updateError } = await supabase\n                .from('appointments')\n                .update({ status: 'cancelled' })\n                .eq('id', id)\n                .select(); \n\n            if (updateError) {\n                throw new Error(updateError.message);\n            }\n            \n            // Força a atualização da lista\n            fetchAndSortAppointments(); \n\n        } catch (e: any) {\n            console.error('Erro ao cancelar agendamento:', e);\n            setError(`Falha ao cancelar o agendamento. Tente novamente. Detalhe: ${e.message}`);\n        } finally {\n            setIsCancelling(null);\n        }\n    };\n\n\n    // Efeito de Polling (Busca a cada 10s para garantir a atualização)\n    useEffect(() => {\n        fetchAndSortAppointments();\n        const interval = setInterval(fetchAndSortAppointments, 10000); \n        return () => clearInterval(interval);\n    }, [clientId, fetchAndSortAppointments]);\n\n\n    if (isLoading) {\n        return (\n            <div className=\"flex items-center justify-center py-10\">\n                <Loader2 className=\"w-6 h-6 text-mani-pink-600 animate-spin\" />\n                <p className=\"ml-3 text-gray-600\">Buscando seus agendamentos...</p>\n            </div>\n        );\n    }\n\n    if (error) {\n        return (\n            <div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg\" role=\"alert\">\n                <p className=\"font-bold\">Erro de Dados</p>\n                <p>{error}</p>\n            </div>\n        );\n    }\n    \n    if (appointments.length === 0) {\n        return (\n            <div className=\"text-center py-10\">\n                <Calendar className=\"w-10 h-10 text-gray-400 mx-auto\" />\n                <h3 className=\"mt-4 text-xl font-semibold text-gray-900\">Você não tem agendamentos</h3>\n                <p className=\"mt-1 text-gray-500\">Clique em \"Agendar Novo Serviço\" para começar.</p>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            <h2 className=\"text-xl font-semibold text-gray-800 border-b pb-2\">Seus Compromissos</h2>\n            \n            <ul className=\"divide-y divide-gray-100\">\n                {appointments.map((appt) => {\n                    const startDate = new Date(appt.start_time);\n                    const dateStr = startDate.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long' });\n                    const timeStr = startDate.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n                    const Status = StatusDisplay[appt.status] || StatusDisplay.pending;\n                    const Icon = Status.icon;\n                    const isActionable = appt.status === 'confirmed' || appt.status === 'pending';\n                    const isBusy = isCancelling === appt.id;\n\n                    return (\n                        <li key={appt.id} className=\"py-4 flex flex-col sm:flex-row justify-between items-start sm:items-center hover:bg-gray-50 transition duration-150 rounded-md px-2\">\n                            \n                            {/* Data e Serviço */}\n                            <div className=\"space-y-1 sm:space-y-0 sm:flex sm:items-center sm:space-x-4\">\n                                <div className=\"text-sm font-semibold text-gray-900 flex items-center\">\n                                    <Clock className=\"w-4 h-4 mr-2 text-mani-pink-500\" />\n                                    {dateStr} às {timeStr}\n                                </div>\n                                <div className=\"text-gray-600 text-sm sm:pl-0 pl-6\">\n                                    Serviço: <span className=\"font-medium\">{getServiceName(appt)} ({getServicePrice(appt)})</span>\n                                </div>\n                            </div>\n\n                            {/* Status e Ações */}\n                            <div className=\"mt-3 sm:mt-0 flex items-center space-x-3\">\n                                {/* Status Chip */}\n                                <span className={`flex items-center text-xs font-medium text-${Status.color}-600 bg-${Status.color}-100 px-3 py-1 rounded-full`}>\n                                    <Icon className=\"w-3 h-3 mr-1\" />\n                                    {Status.label}\n                                </span>\n                                \n                                {/* Ações */}\n                                {isActionable && (\n                                    <button \n                                        onClick={() => handleCancel(appt.id)}\n                                        disabled={isBusy}\n                                        className=\"text-sm font-medium text-red-600 hover:text-red-800 disabled:text-gray-400 flex items-center\"\n                                    >\n                                        {isBusy ? (\n                                            <>\n                                                <Loader2 className=\"w-4 h-4 mr-1 animate-spin\" />\n                                                ...\n                                            </>\n                                        ) : (\n                                            'Cancelar'\n                                        )}\n                                    </button>\n                                )}\n                            </div>\n                        </li>\n                    );\n                })}\n            </ul>\n            \n            <p className=\"text-center pt-4 text-sm text-gray-500 border-t mt-4\">\n                Você tem {appointments.length} agendamentos no total.\n            </p>\n        </div>\n    );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 400, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/components/NewAppointmentModal.tsx"],"sourcesContent":["// Nome do arquivo: components/NewAppointmentModal.tsx\n\"use client\";\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { X, CalendarCheck, Clock, User, Briefcase, Phone, Loader2, Plus, Users } from 'lucide-react';\nimport { supabase } from '../lib/supabaseClient';\n\n// --- Tipos de Dados ---\ntype Profile = {\n  id: string; // UUID\n  name: string;\n};\n\ntype Service = {\n  id: number;\n  name: string;\n  price: number;\n  duration_minutes: number;\n};\n\n// clientCreationMode gerencia se estamos buscando um cliente existente ou criando um novo\ntype ClientMode = 'existing' | 'new';\n\n// Campos do Formulário\ntype AppointmentFormData = {\n  // client_id é o ID real do profile, ou o ID gerado na hora\n  client_id: string; \n  service_id: string; \n  start_time: string; \n  manicure_id: string; \n  \n  // Campos para Novo Cliente (temporários no estado)\n  newClientName: string;\n  newClientPhone: string;\n};\n\n// --- Propriedades do Modal ---\ninterface NewAppointmentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  manicureId: string;\n  onAppointmentCreated: () => void; \n}\n\nconst initialFormData: AppointmentFormData = {\n  client_id: '',\n  service_id: '', \n  start_time: '',\n  manicure_id: '',\n  newClientName: '',\n  newClientPhone: '',\n};\n\nexport default function NewAppointmentModal({ isOpen, onClose, manicureId, onAppointmentCreated }: NewAppointmentModalProps) {\n  const [formData, setFormData] = useState<AppointmentFormData>({ ...initialFormData, manicure_id: manicureId });\n  const [clients, setClients] = useState<Profile[]>([]);\n  const [services, setServices] = useState<Service[]>([]);\n  const [clientMode, setClientMode] = useState<ClientMode>('existing'); // NOVO ESTADO\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n\n  // 1. Carregar Clientes e Serviços da Manicure\n  const fetchData = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      // Busca TODOS os perfis com role 'client'\n      const { data: clientData, error: clientError } = await supabase\n        .from('profiles')\n        .select('id, name')\n        .eq('role', 'client')\n        .order('name', { ascending: true }); // Ordena por nome\n      \n      // Busca Serviços\n      const { data: serviceData, error: serviceError } = await supabase\n        .from('services')\n        .select('id, name, price, duration_minutes')\n        .eq('manicure_id', manicureId);\n\n      if (clientError || serviceError) {\n        throw new Error(clientError?.message || serviceError?.message);\n      }\n\n      setClients(clientData || []);\n      setServices(serviceData || []);\n\n    } catch (e: any) {\n      console.error('Erro ao carregar dados:', e);\n      setError('Falha ao carregar clientes ou serviços. Verifique a conexão com o Supabase e RLS.');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [manicureId]);\n\n  // Função para criar um novo perfil de cliente (sem Auth)\n  const createNewClient = async (name: string, phone: string) => {\n    // Cria um ID único para o cliente não-logado\n    const tempId = crypto.randomUUID(); \n    \n    const { data, error: insertError } = await supabase\n      .from('profiles')\n      .insert({ \n        id: tempId, \n        name: name, \n        phone_number: phone, \n        role: 'client' \n      })\n      .select('id')\n      .single();\n\n    if (insertError) {\n      throw new Error(`Falha ao criar novo cliente: ${insertError.message}`);\n    }\n    \n    // Retorna o ID gerado\n    return data.id; \n  };\n\n\n  useEffect(() => {\n    if (isOpen) {\n      fetchData();\n      // Reseta o modo e o formulário\n      setClientMode('existing'); \n      setFormData({ ...initialFormData, manicure_id: manicureId }); \n    }\n  }, [isOpen, fetchData, manicureId]);\n\n  // Manipulação de Mudanças no Formulário\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  // Função de Submissão do Formulário\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setIsSaving(true);\n    setError(null);\n    \n    let finalClientId = formData.client_id;\n    \n    try {\n      // PASSO 1: TRATAR NOVO CLIENTE\n      if (clientMode === 'new') {\n        if (!formData.newClientName || !formData.newClientPhone) {\n          setError('Nome e Telefone são obrigatórios para novos clientes.');\n          setIsSaving(false);\n          return;\n        }\n        // Cria o cliente e obtém o ID\n        finalClientId = await createNewClient(formData.newClientName, formData.newClientPhone);\n      }\n      \n      // PASSO 2: VALIDAÇÃO FINAL\n      if (!finalClientId || !formData.service_id || !formData.start_time) {\n        setError('Por favor, preencha todos os campos obrigatórios.');\n        setIsSaving(false);\n        return;\n      }\n\n      const serviceIdNumber = Number(formData.service_id);\n      const selectedService = services.find(s => s.id === serviceIdNumber);\n      \n      if (!selectedService || isNaN(serviceIdNumber)) {\n        setError('Serviço inválido ou não selecionado.');\n        setIsSaving(false);\n        return;\n      }\n\n      // PASSO 3: CÁLCULO E SALVAMENTO\n      const startTime = new Date(formData.start_time);\n      const endTime = new Date(startTime.getTime() + selectedService.duration_minutes * 60000); \n\n      const newAppointment = {\n        client_id: finalClientId, // ID do cliente (existente ou novo)\n        manicure_id: formData.manicure_id,\n        service_id: serviceIdNumber, \n        start_time: startTime.toISOString(),\n        end_time: endTime.toISOString(),\n        status: 'pending' as const, // Começa como PENDENTE\n      };\n\n      const { error: insertError } = await supabase\n        .from('appointments')\n        .insert([newAppointment]);\n\n      if (insertError) {\n        throw new Error(insertError.message);\n      }\n\n      // Sucesso\n      onAppointmentCreated(); \n      onClose(); \n      \n    } catch (e: any) {\n      console.error('Erro ao salvar agendamento:', e);\n      setError(`Falha ao salvar. Detalhe: ${e.message}`);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 transition-opacity duration-300\">\n      <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4 transform transition-all duration-300 scale-100\">\n        \n        {/* Header do Modal */}\n        <div className=\"p-6 border-b border-gray-200 flex justify-between items-center\">\n          <h2 className=\"text-2xl font-bold text-gray-800 flex items-center\">\n            <CalendarCheck className=\"w-6 h-6 mr-2 text-mani-pink-600\" />\n            Novo Agendamento\n          </h2>\n          <button onClick={onClose} className=\"p-2 rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition\">\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        {/* Conteúdo do Formulário */}\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n          \n          {error && (\n            <div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded-md text-sm\" role=\"alert\">\n              <p>{error}</p>\n            </div>\n          )}\n          \n          {/* SELETOR DE MODO DO CLIENTE (Existente vs. Novo) */}\n          <div className=\"space-y-3 border-b border-gray-200 pb-4\">\n             <label className=\"block text-sm font-medium text-gray-700 flex items-center mb-1\">\n                <Users className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                Opções de Cliente\n             </label>\n             <div className=\"flex space-x-2\">\n                <button\n                    type=\"button\"\n                    onClick={() => setClientMode('existing')}\n                    className={`flex-1 px-4 py-2 text-sm font-semibold rounded-lg transition ${clientMode === 'existing' ? 'bg-mani-pink-600 text-white shadow-md' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}\n                >\n                    Cliente Existente\n                </button>\n                <button\n                    type=\"button\"\n                    onClick={() => setClientMode('new')}\n                    className={`flex-1 px-4 py-2 text-sm font-semibold rounded-lg transition ${clientMode === 'new' ? 'bg-mani-pink-600 text-white shadow-md' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}\n                >\n                    Novo Cliente\n                </button>\n             </div>\n          </div>\n          \n\n          {/* MODO: SELECIONAR CLIENTE EXISTENTE */}\n          {clientMode === 'existing' && (\n            <div>\n              <label htmlFor=\"client_id\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                <User className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                Selecionar Cliente\n              </label>\n              <div className=\"relative\">\n                <select\n                  id=\"client_id\"\n                  name=\"client_id\"\n                  value={formData.client_id}\n                  onChange={handleChange}\n                  disabled={isLoading || isSaving}\n                  className=\"mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm rounded-lg shadow-sm appearance-none cursor-pointer\"\n                >\n                  <option value=\"\" disabled>Selecione um cliente...</option>\n                  {isLoading ? (\n                    <option disabled>Carregando clientes...</option>\n                  ) : (\n                    clients.map(client => (\n                      <option key={client.id} value={client.id}>\n                        {client.name}\n                      </option>\n                    ))\n                  )}\n                </select>\n                <div className=\"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none\">\n                  <ChevronDown className=\"w-4 h-4 text-gray-400\" />\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* MODO: CADASTRO RÁPIDO DE CLIENTE */}\n          {clientMode === 'new' && (\n            <div className=\"space-y-4\">\n               {/* Nome do Cliente */}\n              <div>\n                <label htmlFor=\"newClientName\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                  <User className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                  Nome do Cliente\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"newClientName\"\n                  name=\"newClientName\"\n                  value={formData.newClientName}\n                  onChange={handleChange}\n                  placeholder=\"Nome completo do novo cliente\"\n                  className=\"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm\"\n                  required\n                />\n              </div>\n              \n              {/* Telefone do Cliente */}\n              <div>\n                <label htmlFor=\"newClientPhone\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                  <Phone className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                  Telefone / WhatsApp\n                </label>\n                <input\n                  type=\"tel\"\n                  id=\"newClientPhone\"\n                  name=\"newClientPhone\"\n                  value={formData.newClientPhone}\n                  onChange={handleChange}\n                  placeholder=\"(99) 99999-9999\"\n                  className=\"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm\"\n                  required\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Seleção de Serviço (Comum aos dois modos) */}\n          <div>\n            <label htmlFor=\"service_id\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n              <Briefcase className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n              Serviço\n            </label>\n            <div className=\"relative\">\n              <select\n                id=\"service_id\"\n                name=\"service_id\"\n                value={formData.service_id}\n                onChange={handleChange}\n                disabled={isLoading || isSaving}\n                className=\"mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm rounded-lg shadow-sm appearance-none cursor-pointer\"\n              >\n                <option value=\"\" disabled>Selecione um serviço...</option>\n                {isLoading ? (\n                  <option disabled>Carregando serviços...</option>\n                ) : (\n                  services.map(service => (\n                    <option key={service.id} value={String(service.id)}>\n                      {service.name} (R$ {service.price.toFixed(2)} / {service.duration_minutes} min)\n                    </option>\n                  ))\n                )}\n              </select>\n              <div className=\"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none\">\n                <ChevronDown className=\"w-4 h-4 text-gray-400\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Data e Hora (Comum aos dois modos) */}\n          <div>\n            <label htmlFor=\"start_time\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n              <Clock className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n              Data e Hora\n            </label>\n            <input\n              type=\"datetime-local\"\n              id=\"start_time\"\n              name=\"start_time\"\n              value={formData.start_time}\n              onChange={handleChange}\n              disabled={isSaving}\n              required\n              className=\"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm\"\n            />\n          </div>\n\n          {/* Rodapé e Botões */}\n          <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-100\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              disabled={isSaving}\n              className=\"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 transition\"\n            >\n              Cancelar\n            </button>\n            <button\n              type=\"submit\"\n              disabled={isSaving || isLoading}\n              className=\"px-5 py-2.5 text-sm font-medium text-white bg-mani-pink-600 rounded-lg shadow-md hover:bg-mani-pink-700 transition flex items-center justify-center\"\n            >\n              {isSaving ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Salvando...\n                </>\n              ) : (\n                'Confirmar Agendamento'\n              )}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\n// Ícone para dropdown\nfunction ChevronDown(props: React.SVGProps<SVGSVGElement>) {\n  return (\n    <svg fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" {...props}>\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n    </svg>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1078, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/app/client-dashboard/page.tsx"],"sourcesContent":["// Nome do arquivo: app/client-dashboard/page.tsx\n\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { supabase } from '../../lib/supabaseClient';\nimport ClientAppointments from '../../components/ClientAppointments';\nimport NewAppointmentModal from '../../components/NewAppointmentModal';\nimport { LogOut, Loader2, Calendar, Settings, User, Plus } from 'lucide-react';\n\n// --- Tipos ---\ntype ClientProfile = {\n    id: string;\n    name: string;\n    email: string;\n    manicureName: string; \n};\n\nconst mockManicure = { name: \"Dona Maria\" }; \n\n// --- Componente: Header do Cliente ---\nfunction ClientHeader({ profile }: { profile: ClientProfile | null }) {\n    const router = useRouter();\n    const handleSignOut = async () => {\n        const { error } = await supabase.auth.signOut();\n        if (!error) {\n            router.replace('/');\n        }\n    };\n\n    return (\n        <header className=\"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10\">\n            <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                <div className=\"flex justify-between items-center h-16\">\n                    <h1 className=\"text-2xl font-bold text-mani-pink-600\">ManiHelp</h1>\n                    \n                    <div className=\"flex items-center space-x-4\">\n                        <div className=\"hidden sm:block text-sm text-gray-600\">\n                            Manicure: <span className=\"font-semibold\">{profile?.manicureName || mockManicure.name}</span>\n                        </div>\n                        <button \n                            onClick={handleSignOut} \n                            className=\"flex items-center space-x-2 text-sm font-medium text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition\"\n                        >\n                            <LogOut className=\"w-4 h-4\" />\n                            Sair\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </header>\n    );\n}\n\n// --- Componente Principal: ClientDashboardPage ---\nexport default function ClientDashboardPage() {\n    const router = useRouter();\n    const [profile, setProfile] = useState<ClientProfile | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const [isModalOpen, setIsModalOpen] = useState(false); \n    const [error, setError] = useState<string | null>(null);\n\n\n    // Otimizado: A função agora só fecha o modal, pois o ClientAppointments\n    // faz a atualização em tempo real (Realtime).\n    const handleAppointmentCreated = () => {\n      setIsModalOpen(false); \n      // Não precisa de re-fetch manual aqui!\n    };\n\n    // 1. CARREGAMENTO E AUTORIZAÇÃO (Cliente)\n    useEffect(() => {\n        async function checkAuthAndLoadProfile() {\n            const { data: { user } } = await supabase.auth.getUser();\n            \n            if (!user) {\n                router.replace('/'); \n                return;\n            }\n            \n            const { data: profileData, error } = await supabase\n                .from('profiles')\n                .select('id, name, role')\n                .eq('id', user.id)\n                .single();\n            \n            if (error || profileData?.role !== 'client') {\n                await supabase.auth.signOut();\n                router.replace('/');\n                return;\n            }\n\n            setProfile({ \n                id: profileData.id, \n                name: profileData.name,\n                email: user.email || '', \n                manicureName: mockManicure.name \n            });\n            setIsLoading(false);\n        }\n        checkAuthAndLoadProfile();\n\n        const { data: { subscription } } = supabase.auth.onAuthStateChange((event) => {\n            if (event === 'SIGNED_OUT') {\n                router.replace('/');\n            }\n        });\n        return () => subscription.unsubscribe();\n    }, [router]);\n\n    if (isLoading || !profile) {\n        return (\n            <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n                <Loader2 className=\"w-8 h-8 text-mani-pink-600 animate-spin\" />\n                <p className=\"ml-3 text-gray-600\">Verificando sua conta...</p>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-gray-100 font-inter\">\n            <ClientHeader profile={profile} />\n\n            <main className=\"max-w-4xl mx-auto py-10 px-4 sm:px-6 lg:px-8\">\n                \n                {/* Cabeçalho de Boas-Vindas e CTA */}\n                <div className=\"text-center mb-10 space-y-2\">\n                    <h1 className=\"text-3xl font-bold text-gray-900\">\n                        Olá, {profile.name}!\n                    </h1>\n                    <p className=\"text-lg text-gray-600\">\n                        Gerencie seus agendamentos com facilidade.\n                    </p>\n                </div>\n                \n                {/* Área Principal - Agendamentos */}\n                <div className=\"bg-white rounded-xl shadow-2xl p-6 md:p-8 space-y-6\">\n                    \n                    {/* Botão de Nova Ação (CTA) */}\n                    <div className=\"border-b border-gray-100 pb-6\">\n                        <button \n                            onClick={() => setIsModalOpen(true)}\n                            className=\"w-full flex items-center justify-center bg-mani-pink-600 text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:bg-mani-pink-700 transition\"\n                        >\n                            <Calendar className=\"w-5 h-5 mr-2\" />\n                            Agendar Novo Serviço\n                        </button>\n                    </div>\n\n                    {/* Lista de Agendamentos */}\n                    <ClientAppointments clientId={profile.id} />\n                </div>\n\n                {/* Rodapé - Configurações */}\n                <div className=\"mt-8 text-center\">\n                    <a href=\"#\" className=\"text-sm font-medium text-gray-500 hover:text-mani-pink-600 flex items-center justify-center\">\n                        <Settings className=\"w-4 h-4 mr-2\" />\n                        Gerenciar Perfil e Contato\n                    </a>\n                </div>\n            </main>\n            \n            {/* Modal de Novo Agendamento */}\n            {profile.id && (\n                <NewAppointmentModal \n                    isOpen={isModalOpen} \n                    onClose={() => setIsModalOpen(false)} \n                    // Passamos o ID do Cliente como manicureId - Isso precisa ser corrigido para a Manicure real\n                    // Por enquanto, apenas para abrir o modal.\n                    manicureId={profile.id} \n                    onAppointmentCreated={handleAppointmentCreated}\n                />\n            )}\n        </div>\n    );\n}"],"names":[],"mappings":"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","debugId":null}}]
}