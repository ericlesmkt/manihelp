{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/lib/supabaseClient.ts"],"sourcesContent":["// Nome do arquivo: lib/supabaseClient.ts\nimport { createClient } from '@supabase/supabase-js';\n\n// As variáveis de ambiente são lidas do .env.local\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n// Verifica se as variáveis estão definidas\nif (!supabaseUrl || !supabaseKey) {\n  throw new Error('As variáveis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY são obrigatórias.');\n}\n\n// Cria e exporta o cliente Supabase\nexport const supabase = createClient(supabaseUrl, supabaseKey);"],"names":[],"mappings":"AAAA,yCAAyC;;;;;AACzC;;AAEA,mDAAmD;AACnD,MAAM;AACN,MAAM;AAEN,2CAA2C;AAC3C;;AAKO,MAAM,WAAW,IAAA,uMAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/components/NewAppointmentModal.tsx"],"sourcesContent":["// Nome do arquivo: components/NewAppointmentModal.tsx\n\"use client\";\n\nimport React, { useState, useEffect, useCallback, forwardRef } from 'react';\n// Ícones (sem DatePicker)\nimport { X, CalendarCheck, Clock, User, Briefcase, Phone, Loader2, Users, ChevronDown } from 'lucide-react';\nimport { supabase } from '../lib/supabaseClient';\n// REMOVIDO: import DatePicker, date-fns, etc.\n\n// --- Tipos de Dados ---\ntype Profile = {\n  id: string; // UUID\n  name: string;\n};\n\ntype Service = {\n  id: number;\n  name: string;\n  price: number;\n  duration_minutes: number;\n};\n\ntype ClientMode = 'existing' | 'new';\n\ntype AppointmentFormData = {\n  client_id: string; \n  service_id: string; \n  start_time: string; // String do input datetime-local\n  manicure_id: string; \n  \n  newClientName: string;\n  newClientPhone: string; // Armazena o telefone formatado\n};\n\n// --- Propriedades do Modal ---\ninterface NewAppointmentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  manicureId: string;\n  onAppointmentCreated: () => void; \n}\n\nconst initialFormData: AppointmentFormData = {\n  client_id: '',\n  service_id: '', \n  start_time: '', \n  manicure_id: '',\n  newClientName: '',\n  newClientPhone: '',\n};\n\n// --- FUNÇÃO DE MÁSCARA (Mantida) ---\nconst maskPhoneNumber = (value: string) => {\n  if (!value) return \"\";\n  value = value.replace(/\\D/g, \"\"); \n  if (value.length > 11) value = value.substring(0, 11);\n  value = value.replace(/^(\\d{2})(\\d)/g, \"($1) $2\");\n  value = value.replace(/(\\d{5})(\\d)/, \"$1-$2\");\n  return value;\n};\n\n\nexport default function NewAppointmentModal({ isOpen, onClose, manicureId, onAppointmentCreated }: NewAppointmentModalProps) {\n  const [formData, setFormData] = useState<AppointmentFormData>({ ...initialFormData, manicure_id: manicureId });\n  const [clients, setClients] = useState<Profile[]>([]);\n  const [services, setServices] = useState<Service[]>([]);\n  const [clientMode, setClientMode] = useState<ClientMode>('existing');\n  // REMOVIDO: [selectedDate, setSelectedDate]\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n\n  // 1. Carregar Clientes e Serviços da Manicure\n  const fetchData = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const { data: clientData, error: clientError } = await supabase\n        .from('profiles')\n        .select('id, name')\n        .eq('role', 'client')\n        .order('name', { ascending: true }); \n      \n      const { data: serviceData, error: serviceError } = await supabase\n        .from('services')\n        .select('id, name, price, duration_minutes')\n        .eq('manicure_id', manicureId);\n\n      if (clientError || serviceError) {\n        throw new Error(clientError?.message || serviceError?.message);\n      }\n      setClients(clientData || []);\n      setServices(serviceData || []);\n    } catch (e: any) {\n      console.error('Erro ao carregar dados:', e);\n      setError('Falha ao carregar clientes ou serviços.');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [manicureId]);\n\n  // REMOVIDO: createNewClient (agora é createGuestAppointment)\n  \n  useEffect(() => {\n    if (isOpen) {\n      fetchData();\n      setClientMode('existing'); \n      setFormData({ ...initialFormData, manicure_id: manicureId }); \n      // REMOVIDO: setSelectedDate\n    }\n  }, [isOpen, fetchData, manicureId]);\n\n  // Manipulador genérico\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  // Manipulador da máscara\n  const handlePhoneChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      const maskedValue = maskPhoneNumber(e.target.value);\n      setFormData(prev => ({ ...prev, newClientPhone: maskedValue }));\n  };\n  \n\n  // --- SUBMIT CORRIGIDO ---\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setIsSaving(true);\n    setError(null);\n    \n    // Objeto base do agendamento\n    let appointmentPayload: any = {\n      manicure_id: formData.manicure_id,\n      status: 'pending' as const,\n    };\n    \n    try {\n      // 1. Validação de Data/Serviço\n      if (!formData.start_time || !formData.service_id) {\n          setError('Serviço e Data/Hora são obrigatórios.');\n          setIsSaving(false);\n          return;\n      }\n      \n      const serviceIdNumber = Number(formData.service_id);\n      const selectedService = services.find(s => s.id === serviceIdNumber);\n      if (!selectedService) throw new Error(\"Serviço inválido.\");\n\n      const startTime = new Date(formData.start_time);\n      const endTime = new Date(startTime.getTime() + selectedService.duration_minutes * 60000);\n      \n      appointmentPayload = {\n          ...appointmentPayload,\n          service_id: serviceIdNumber, \n          start_time: startTime.toISOString(), \n          end_time: endTime.toISOString(),\n      };\n\n      // 2. Validação de Cliente (Convidado ou Existente)\n      if (clientMode === 'new') {\n        if (!formData.newClientName || !formData.newClientPhone) {\n          setError('Nome e Telefone são obrigatórios para novos clientes.');\n          setIsSaving(false);\n          return;\n        }\n        \n        const cleanPhone = formData.newClientPhone.replace(/\\D/g, \"\");\n        if (cleanPhone.length !== 11) {\n            setError('O Telefone deve ter 11 dígitos (DDD + 9 dígitos).');\n            setIsSaving(false);\n            return;\n        }\n\n        // Salva como Convidado\n        appointmentPayload = {\n            ...appointmentPayload,\n            client_id: null, // Nulo, pois não tem perfil\n            guest_name: formData.newClientName,\n            guest_phone: cleanPhone, // Salva o telefone limpo\n        };\n\n      } else {\n        if (!formData.client_id) {\n            setError('Selecione um cliente existente.');\n            setIsSaving(false);\n            return;\n        }\n        // Salva com o Perfil existente\n        appointmentPayload = {\n            ...appointmentPayload,\n            client_id: formData.client_id,\n            guest_name: null,\n            guest_phone: null,\n        };\n      }\n      \n      // 3. Inserção no Banco\n      const { error: insertError } = await supabase\n        .from('appointments')\n        .insert([appointmentPayload]);\n\n      if (insertError) {\n        throw new Error(insertError.message);\n      }\n\n      // Sucesso\n      onAppointmentCreated(); \n      onClose(); \n      \n    } catch (e: any) {\n      console.error('Erro ao salvar agendamento:', e);\n      setError(`Falha ao salvar. Detalhe: ${e.message}`);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[100] transition-opacity duration-300\">\n      {/* REMOVIDO: Bloco <style> do DatePicker */}\n      <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4 transform transition-all duration-300 scale-100\">\n        \n        {/* Header do Modal */}\n        <div className=\"p-6 border-b border-gray-200 flex justify-between items-center\">\n          <h2 className=\"text-2xl font-bold text-gray-800 flex items-center\">\n            <CalendarCheck className=\"w-6 h-6 mr-2 text-mani-pink-600\" />\n            Novo Agendamento\n          </h2>\n          <button onClick={onClose} className=\"p-2 rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition\">\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        {/* Conteúdo do Formulário */}\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n          \n          {error && (\n            <div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded-md text-sm\" role=\"alert\">\n              <p>{error}</p>\n            </div>\n          )}\n          \n          {/* SELETOR DE MODO DO CLIENTE (Existente vs. Novo) */}\n          <div className=\"space-y-3 border-b border-gray-200 pb-4\">\n             <label className=\"block text-sm font-medium text-gray-700 flex items-center mb-1\">\n                <Users className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                Opções de Cliente\n             </label>\n             <div className=\"flex space-x-2\">\n                <button\n                    type=\"button\"\n                    onClick={() => setClientMode('existing')}\n                    className={`flex-1 px-4 py-2 text-sm font-semibold rounded-lg transition ${clientMode === 'existing' ? 'bg-mani-pink-600 text-white shadow-md' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}\n                >\n                    Cliente Existente\n                </button>\n                <button\n                    type=\"button\"\n                    onClick={() => setClientMode('new')}\n                    className={`flex-1 px-4 py-2 text-sm font-semibold rounded-lg transition ${clientMode === 'new' ? 'bg-mani-pink-600 text-white shadow-md' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}\n                >\n                    Novo Cliente (Convidado)\n                </button>\n             </div>\n          </div>\n          \n\n          {/* MODO: SELECIONAR CLIENTE EXISTENTE */}\n          {clientMode === 'existing' && (\n            <div>\n              <label htmlFor=\"client_id\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                <User className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                Selecionar Cliente\n              </label>\n              <div className=\"relative\">\n                <select\n                  id=\"client_id\"\n                  name=\"client_id\"\n                  value={formData.client_id}\n                  onChange={handleChange}\n                  disabled={isLoading || isSaving}\n                  className=\"mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm rounded-lg shadow-sm appearance-none cursor-pointer\"\n                >\n                  <option value=\"\" disabled>Selecione um cliente...</option>\n                  {isLoading ? (\n                    <option disabled>Carregando clientes...</option>\n                  ) : (\n                    clients.map(client => (\n                      <option key={client.id} value={client.id}>\n                        {client.name}\n                      </option>\n                    ))\n                  )}\n                </select>\n                <div className=\"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none\">\n                  <ChevronDown className=\"w-4 h-4 text-gray-400\" />\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* MODO: CADASTRO RÁPIDO DE CLIENTE */}\n          {clientMode === 'new' && (\n            <div className=\"space-y-4\">\n               {/* Nome do Cliente */}\n              <div>\n                <label htmlFor=\"newClientName\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                  <User className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                  Nome do Cliente (Convidado)\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"newClientName\"\n                  name=\"newClientName\"\n                  value={formData.newClientName}\n                  onChange={handleChange}\n                  placeholder=\"Nome completo do novo cliente\"\n                  className=\"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm\"\n                  required\n                />\n              </div>\n              \n              {/* Telefone do Cliente (COM MÁSCARA) */}\n              <div>\n                <label htmlFor=\"newClientPhone\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n                  <Phone className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n                  Telefone / WhatsApp\n                </label>\n                <input\n                  type=\"tel\"\n                  id=\"newClientPhone\"\n                  name=\"newClientPhone\"\n                  value={formData.newClientPhone}\n                  onChange={handlePhoneChange} \n                  maxLength={15} \n                  placeholder=\"(99) 99999-9999\"\n                  className=\"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm\"\n                  required\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Seleção de Serviço (Comum aos dois modos) */}\n          <div>\n            <label htmlFor=\"service_id\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n              <Briefcase className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n              Serviço\n            </label>\n            <div className=\"relative\">\n              <select\n                id=\"service_id\"\n                name=\"service_id\"\n                value={formData.service_id}\n                onChange={handleChange}\n                disabled={isLoading || isSaving}\n                className=\"mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm rounded-lg shadow-sm appearance-none cursor-pointer\"\n              >\n                <option value=\"\" disabled>Selecione um serviço...</option>\n                {isLoading ? (\n                  <option disabled>Carregando serviços...</option>\n                ) : (\n                  services.map(service => (\n                    <option key={service.id} value={String(service.id)}>\n                      {service.name}\n                    </option>\n                  ))\n                )}\n              </select>\n              <div className=\"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none\">\n                  <ChevronDown className=\"w-4 h-4 text-gray-400\" />\n                </div>\n              </div>\n          </div>\n\n          {/* Data e Hora (REVERTIDO PARA HTML PADRÃO) */}\n          <div>\n            <label htmlFor=\"start_time\" className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center\">\n              <Clock className=\"w-4 h-4 mr-1 text-mani-pink-600\" />\n              Data e Hora\n            </label>\n            <input\n              type=\"datetime-local\"\n              id=\"start_time\"\n              name=\"start_time\"\n              value={formData.start_time}\n              onChange={handleChange}\n              disabled={isSaving}\n              required\n              // Estilo ajustado para ser mais amigável\n              className=\"mt-1 block w-full py-3 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm\"\n            />\n          </div>\n\n          {/* Rodapé e Botões */}\n          <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-100\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              disabled={isSaving}\n              className=\"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 transition\"\n            >\n              Cancelar\n            </button>\n            <button\n              type=\"submit\"\n              disabled={isSaving || isLoading}\n              className=\"px-5 py-2.5 text-sm font-medium text-white bg-mani-pink-600 rounded-lg shadow-md hover:bg-mani-pink-700 transition flex items-center justify-center\"\n            >\n              {isSaving ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Salvando...\n                </>\n              ) : (\n                'Confirmar Agendamento'\n              )}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 721, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/components/NotificationBell.tsx"],"sourcesContent":["// Nome do arquivo: components/NotificationBell.tsx\n\"use client\";\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '../lib/supabaseClient';\nimport { Bell, Loader2, Trash2 } from 'lucide-react';\n\n// --- Tipos ---\ntype NotificationItem = { \n    id: number; \n    message: string; \n    is_read: boolean; \n    created_at: string; \n    type: string; \n};\n\nexport default function NotificationBell({ manicureId }: { manicureId: string }) {\n    const [notifications, setNotifications] = useState<NotificationItem[]>([]);\n    const [isOpen, setIsOpen] = useState(false);\n    const unreadCount = notifications.filter(n => !n.is_read).length;\n\n    const fetchNotifications = useCallback(async () => {\n        if (!manicureId) return;\n\n        const { data, error } = await supabase\n            .from('notifications')\n            .select('*')\n            .eq('manicure_id', manicureId)\n            .order('created_at', { ascending: false })\n            .limit(10); \n\n        if (!error) {\n            setNotifications(data as NotificationItem[]);\n        }\n    }, [manicureId]);\n\n    // Lógica de Realtime para Notificações\n    useEffect(() => {\n        fetchNotifications();\n\n        // Se inscreve para receber notificações em tempo real\n        const channel = supabase\n            .channel(`manicure_notifications_${manicureId}`)\n            .on(\n                'postgres_changes',\n                // O trigger SQL garante que apenas 'INSERT's cheguem aqui para notificar o sino\n                { event: 'INSERT', schema: 'public', table: 'notifications', filter: `manicure_id=eq.${manicureId}` },\n                () => {\n                    fetchNotifications(); // Re-fetch na inserção\n                }\n            )\n            .subscribe();\n\n        return () => { supabase.removeChannel(channel); };\n    }, [manicureId, fetchNotifications]);\n\n    // Marca todas as notificações visíveis como lidas\n    const handleMarkAsRead = async () => {\n        const idsToMark = notifications.filter(n => !n.is_read).map(n => n.id);\n        if (idsToMark.length === 0) return;\n\n        await supabase\n            .from('notifications')\n            .update({ is_read: true })\n            .in('id', idsToMark);\n            \n        // Atualiza o estado local para refletir a leitura\n        setNotifications(notifications.map(n => ({...n, is_read: true})));\n    };\n    \n    // Função utilitária para formatar o tempo\n    const formatTime = (isoString: string) => {\n        const diff = new Date().getTime() - new Date(isoString).getTime();\n        const minutes = Math.floor(diff / 60000);\n        if (minutes < 1) return \"Agora\";\n        if (minutes < 60) return `${minutes} min atrás`;\n        const hours = Math.floor(minutes / 60);\n        if (hours < 24) return `${hours} h atrás`;\n        return new Date(isoString).toLocaleDateString('pt-BR');\n    };\n\n    return (\n        <div className=\"relative\">\n            <button \n                onClick={() => { setIsOpen(!isOpen); if (isOpen) handleMarkAsRead(); }} \n                className=\"text-gray-400 hover:text-gray-500 rounded-full p-1 relative\"\n            >\n                <Bell className=\"w-6 h-6\" />\n                {unreadCount > 0 && (\n                    <span className=\"absolute top-0 right-0 block h-2 w-2 rounded-full bg-mani-pink-500 ring-2 ring-white animate-pulse\" />\n                )}\n            </button>\n\n            {isOpen && (\n                <div \n                    className=\"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl py-2 ring-1 ring-black ring-opacity-5 z-50 transform translate-x-2\"\n                    // Marca como lido quando o mouse sai do pop-up\n                    onMouseLeave={() => { setIsOpen(false); handleMarkAsRead(); }}\n                >\n                    <div className=\"px-4 py-2 text-lg font-semibold text-gray-800 border-b\">Notificações</div>\n                    \n                    {notifications.length === 0 ? (\n                        <p className=\"p-4 text-center text-gray-500 text-sm\">Nenhuma notificação recente.</p>\n                    ) : (\n                        <ul className=\"max-h-80 overflow-y-auto\">\n                            {notifications.map(n => (\n                                <li \n                                    key={n.id} \n                                    className={`px-4 py-3 border-b text-sm transition ${!n.is_read ? 'bg-mani-pink-50' : 'hover:bg-gray-50'}`}\n                                >\n                                    <p className={`font-medium ${!n.is_read ? 'text-gray-900' : 'text-gray-700'}`}>\n                                        {n.message}\n                                    </p>\n                                    <p className=\"text-xs text-gray-400 mt-1\">\n                                        {formatTime(n.created_at)}\n                                    </p>\n                                </li>\n                            ))}\n                        </ul>\n                    )}\n                    \n                </div>\n            )}\n        </div>\n    );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 895, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/components/AppointmentDetailModal.tsx"],"sourcesContent":["// Nome do arquivo: components/AppointmentDetailModal.tsx\n\"use client\";\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { supabase } from '../lib/supabaseClient';\nimport { X, User, Phone, Briefcase, DollarSign, Clock, Calendar, Check, AlertTriangle, CalendarCheck, Save, Loader2, MessageSquare, Trash2, Pencil } from 'lucide-react';\n\n// --- Tipos ---\ntype ProfileData = { id: string; name: string; phone_number: string };\ntype ServiceData = { id: number; name: string; price: number; duration_minutes: number; }; // Corrigido para duration_minutes\n\ntype AppointmentItem = {\n    id: number;\n    start_time: string; \n    end_time: string;\n    status: 'pending' | 'confirmed' | 'cancelled' | 'completed';\n    guest_name: string | null; \n    guest_phone: string | null;\n    client_id: ProfileData[] | null; \n    service_id: ServiceData[] | null; \n    notes: string | null;\n    override_price: number | null; \n};\n\n// --- Propriedades ---\ninterface DetailModalProps {\n    appointment: AppointmentItem | null; \n    manicureId: string; // CORREÇÃO: Recebe o ID da manicure\n    onClose: () => void;\n    onUpdate: () => void; \n}\n\n// --- Funções Auxiliares ---\nconst getClientName = (appt: AppointmentItem) => {\n    if (appt.client_id && appt.client_id.length > 0) return appt.client_id[0].name;\n    return appt.guest_name || 'Cliente (Convidado)';\n};\nconst getClientPhone = (appt: AppointmentItem) => {\n    if (appt.client_id && appt.client_id.length > 0) return appt.client_id[0].phone_number;\n    return appt.guest_phone || 'Não informado';\n};\nconst getServiceName = (appt: AppointmentItem) => (appt.service_id && appt.service_id[0] ? appt.service_id[0].name : 'Serviço Removido');\nconst getPrice = (appt: AppointmentItem) => {\n    if (appt.override_price !== null) {\n        return appt.override_price;\n    }\n    if (appt.service_id && appt.service_id[0]) {\n        return appt.service_id[0].price;\n    }\n    return 0;\n};\nconst getServiceId = (appt: AppointmentItem) => (appt.service_id && appt.service_id[0] ? appt.service_id[0].id : 0);\n\nconst formatDate = (dateString: string) => new Date(dateString).toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' });\nconst formatTime = (dateString: string) => new Date(dateString).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n\nexport default function AppointmentDetailModal({ appointment, manicureId, onClose, onUpdate }: DetailModalProps) {\n    \n    // Estados para Edição\n    const [notes, setNotes] = useState(appointment?.notes || '');\n    const [price, setPrice] = useState('0.00');\n    const [selectedServiceId, setSelectedServiceId] = useState<number>(0); \n    const [availableServices, setAvailableServices] = useState<ServiceData[]>([]);\n\n    const [isSaving, setIsSaving] = useState(false);\n    const [isCancelling, setIsCancelling] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    // Busca todos os serviços da manicure para o dropdown\n    const fetchServices = useCallback(async (mId: string) => {\n        if (!mId) return;\n        const { data, error } = await supabase\n            .from('services')\n            .select('id, name, price, duration_minutes')\n            .eq('manicure_id', mId);\n        \n        if (!error && data) {\n            setAvailableServices(data as ServiceData[]);\n        }\n    }, []);\n\n    // Carrega os dados no estado local quando o modal abre\n    useEffect(() => {\n        if (appointment && manicureId) {\n            setNotes(appointment.notes || '');\n            setPrice(getPrice(appointment).toFixed(2).replace('.', ','));\n            setSelectedServiceId(getServiceId(appointment));\n            setError(null);\n            \n            // CORREÇÃO: Usa o manicureId da prop para buscar os serviços\n            fetchServices(manicureId);\n        }\n    }, [appointment, manicureId, fetchServices]);\n\n    if (!appointment) return null;\n\n    // --- AÇÕES DO MODAL ---\n    \n    const handlePriceChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        let value = e.target.value;\n        value = value.replace(/[^\\d.,]/g, ''); \n        value = value.replace(',', '.'); \n        setPrice(value);\n    };\n\n    // Manipulador de mudança de serviço\n    const handleServiceChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n        const newServiceId = Number(e.target.value);\n        setSelectedServiceId(newServiceId);\n        \n        // Atualiza o preço automaticamente para o preço do novo serviço\n        const newService = availableServices.find(s => s.id === newServiceId);\n        if (newService) {\n            setPrice(newService.price.toFixed(2).replace('.', ','));\n        }\n    };\n\n\n    // Salvar Preço, Serviço e Observações\n    const handleSaveEdits = async () => {\n        setIsSaving(true);\n        setError(null);\n        \n        const newPrice = parseFloat(price.replace(',', '.'));\n        const newServiceId = Number(selectedServiceId);\n        \n        if (isNaN(newPrice) || isNaN(newServiceId) || newServiceId === 0) {\n            setError('Valor ou Serviço inválido.');\n            setIsSaving(false);\n            return;\n        }\n        \n        const selectedService = availableServices.find(s => s.id === newServiceId);\n        if (!selectedService) {\n            setError('Serviço selecionado não encontrado.');\n            setIsSaving(false);\n            return;\n        }\n        \n        // RECALCULA O END_TIME\n        const startTime = new Date(appointment.start_time);\n        const newEndTime = new Date(startTime.getTime() + selectedService.duration_minutes * 60000);\n\n        try {\n            const { error } = await supabase\n                .from('appointments')\n                .update({ \n                    notes: notes,\n                    override_price: newPrice,\n                    service_id: newServiceId,\n                    end_time: newEndTime.toISOString() \n                })\n                .eq('id', appointment.id);\n            if (error) throw error;\n            \n            onUpdate(); // Atualiza o dashboard\n            onClose(); // Fecha o modal\n        } catch (e: any) {\n            setError('Falha ao salvar alterações.');\n        } finally {\n            setIsSaving(false);\n        }\n    };\n\n    // Cancelar Agendamento\n    const handleCancelAppointment = async () => {\n        if (!confirm('Tem certeza que deseja cancelar este agendamento? Esta ação é irreversível.')) return;\n        \n        setIsCancelling(true);\n        setError(null);\n        try {\n            const { error } = await supabase\n                .from('appointments')\n                .update({ status: 'cancelled' })\n                .eq('id', appointment.id);\n            if (error) throw error;\n            onUpdate(); // Atualiza o dashboard\n            onClose(); // Fecha o modal\n        } catch (e: any) {\n            setError('Falha ao cancelar agendamento.');\n        } finally {\n            setIsCancelling(false);\n        }\n    };\n\n    // --- DADOS FORMATADOS ---\n    const clientName = getClientName(appointment);\n    const clientPhone = getClientPhone(appointment);\n    const date = formatDate(appointment.start_time);\n    const time = formatTime(appointment.start_time);\n    const status = appointment.status;\n\n    const statusInfo = {\n        pending: { text: \"Pendente\", icon: Clock, color: \"text-yellow-600\" },\n        confirmed: { text: \"Confirmado\", icon: Check, color: \"text-green-600\" },\n        cancelled: { text: \"Cancelado\", icon: X, color: \"text-red-600\" },\n        completed: { text: \"Concluído\", icon: CalendarCheck, color: \"text-gray-500\" },\n    };\n    const CurrentStatus = statusInfo[status];\n    const isPast = new Date(appointment.start_time) < new Date();\n\n\n    return (\n        <div \n            className=\"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[100] transition-opacity duration-300\"\n            onClick={onClose} \n        >\n            <div \n                className=\"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4\"\n                onClick={(e) => e.stopPropagation()} \n            >\n                {/* Header */}\n                <div className=\"p-6 border-b border-gray-200 flex justify-between items-center\">\n                    <h2 className=\"text-2xl font-bold text-gray-800 flex items-center\">\n                        <Pencil className=\"w-6 h-6 mr-2 text-mani-pink-600\" />\n                        Editar Agendamento\n                    </h2>\n                    <button onClick={onClose} className=\"p-2 rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition\">\n                        <X className=\"w-6 h-6\" />\n                    </button>\n                </div>\n\n                {/* Corpo */}\n                <div className=\"p-6 space-y-5 max-h-[70vh] overflow-y-auto\">\n                    \n                    {error && (\n                        <div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-3 rounded-md text-sm\">\n                            {error}\n                        </div>\n                    )}\n                    \n                    {/* Status */}\n                    <div className={`p-4 rounded-lg flex items-center ${CurrentStatus.color.replace('text-', 'bg-').replace('-600', '-100')}`}>\n                        <CurrentStatus.icon className={`w-6 h-6 mr-3 ${CurrentStatus.color}`} />\n                        <span className={`text-lg font-semibold ${CurrentStatus.color}`}>{CurrentStatus.text}</span>\n                    </div>\n\n                    {/* Informações (Cliente e Data/Hora são fixos) */}\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                        <div className=\"bg-gray-50 p-4 rounded-lg\">\n                            <label className=\"block text-sm font-medium text-gray-500 mb-1 flex items-center\"><User className=\"w-4 h-4 mr-1\" /> Cliente</label>\n                            <p className=\"text-lg font-semibold text-gray-900\">{clientName}</p>\n                        </div>\n                        <div className=\"bg-gray-50 p-4 rounded-lg\">\n                            <label className=\"block text-sm font-medium text-gray-500 mb-1 flex items-center\"><Phone className=\"w-4 h-4 mr-1\" /> Telefone (WhatsApp)</label>\n                            <p className=\"text-lg font-semibold text-gray-900\">{clientPhone}</p>\n                        </div>\n                    </div>\n                    <div className=\"bg-mani-pink-50 p-4 rounded-lg border border-mani-pink-200\">\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\"><Clock className=\"w-4 h-4 mr-1\" /> Data e Hora (Fixo)</label>\n                        <p className=\"text-xl font-bold text-mani-pink-700\">{date} às {time}</p>\n                    </div>\n\n                    \n                    {/* --- CAMPOS DE EDIÇÃO --- */}\n                    \n                    {/* CAMPO DE SERVIÇO (Editável) */}\n                    <div>\n                        <label htmlFor=\"service_id\" className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\">\n                            <Briefcase className=\"w-4 h-4 mr-1\" />\n                            Serviço\n                        </label>\n                        <select\n                            id=\"service_id\"\n                            name=\"service_id\"\n                            value={selectedServiceId}\n                            onChange={handleServiceChange}\n                            disabled={isSaving}\n                            className=\"mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 sm:text-sm rounded-lg shadow-sm appearance-none cursor-pointer\"\n                        >\n                            <option value={0} disabled>Selecione um serviço...</option>\n                            {availableServices.map(service => (\n                                <option key={service.id} value={service.id}>\n                                    {service.name} (R$ {service.price.toFixed(2)})\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n                    \n                    {/* CAMPO DE PREÇO (Editável) */}\n                    <div>\n                        <label htmlFor=\"price\" className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\">\n                            <DollarSign className=\"w-4 h-4 mr-1\" /> Valor (R$) - Ajuste\n                        </label>\n                        <input \n                            type=\"text\"\n                            inputMode=\"decimal\"\n                            id=\"price\"\n                            value={price}\n                            onChange={handlePriceChange}\n                            className=\"text-lg font-semibold text-gray-900 bg-white border border-gray-300 rounded-lg p-2 w-full\"\n                        />\n                    </div>\n                    \n                    {/* CAMPO DE OBSERVAÇÕES */}\n                    <div>\n                        <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\">\n                            <MessageSquare className=\"w-4 h-4 mr-1\" />\n                            Observações (Internas)\n                        </label>\n                        <textarea\n                            id=\"notes\"\n                            value={notes}\n                            onChange={(e) => setNotes(e.target.value)}\n                            rows={3}\n                            className=\"mt-1 w-full py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-mani-pink-500 focus:border-mani-pink-500 resize-none\"\n                            placeholder=\"Ex: Cliente prefere esmalte claro, alergia a acetona...\"\n                        />\n                    </div>\n                    \n                    {/* Botão de Salvar Alterações (Preço e Notas) */}\n                    <button\n                        onClick={handleSaveEdits}\n                        disabled={isSaving}\n                        className=\"w-full px-4 py-2 text-sm font-medium text-white bg-mani-pink-600 rounded-lg shadow-md hover:bg-mani-pink-700 transition flex items-center justify-center disabled:opacity-50\"\n                    >\n                        {isSaving ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\n                        Salvar Alterações\n                    </button>\n                    \n                </div>\n\n                {/* Rodapé de Ações */}\n                <div className=\"p-4 bg-gray-50 border-t flex justify-between items-center rounded-b-xl\">\n                    <button\n                        onClick={onClose}\n                        className=\"px-5 py-2.5 text-sm font-medium text-gray-700\"\n                    >\n                        Fechar\n                    </button>\n                    \n                    {/* BOTÃO DE CANCELAR */}\n                    {(status === 'pending' || status === 'confirmed') && !isPast && (\n                         <button\n                            onClick={handleCancelAppointment}\n                            disabled={isCancelling}\n                            className=\"px-5 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg shadow-md hover:bg-red-700 transition flex items-center justify-center disabled:opacity-50\"\n                        >\n                            {isCancelling ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Trash2 className=\"w-4 h-4 mr-2\" />}\n                            Cancelar Agendamento\n                        </button>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1510, "column": 0}, "map": {"version":3,"sources":["file:///Users/ericles/Documents/Palestra%20Gemini/manihelp/app/dashboard/page.tsx"],"sourcesContent":["// Nome do arquivo: app/dashboard/page.tsx\n\"use client\";\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { \n  Calendar, \n  Users, \n  BarChart3, \n  Settings, \n  Plus, \n  Bell, \n  ChevronDown, \n  LogOut, \n  Check,\n  Clock,\n  Loader2,\n  AlertTriangle,\n  User as UserIcon,\n  DollarSign,\n  CalendarCheck,\n  ClipboardCheck,\n  Lock,\n  Briefcase, \n  Trash2,\n  Info \n} from 'lucide-react';\nimport { supabase } from '../../lib/supabaseClient'; \nimport NewAppointmentModal from '../../components/NewAppointmentModal';\nimport NotificationBell from '../../components/NotificationBell'; \nimport AppointmentDetailModal from '../../components/AppointmentDetailModal'; \n\n\n// --- Tipos de Dados (Baseados no seu esquema) ---\ntype ProfileData = { id: string; name: string; phone_number: string };\ntype ServiceData = { id: number; name: string; price: number };\ntype NotificationItem = { id: number; message: string; is_read: boolean; created_at: string; type: string }; \n\n// CORREÇÃO: Adicionado override_price e notes (para o modal de detalhes)\ntype AppointmentItem = {\n    id: number;\n    start_time: string; \n    end_time: string;\n    status: 'pending' | 'confirmed' | 'cancelled' | 'completed';\n    guest_name: string | null; \n    guest_phone: string | null;\n    notes: string | null;\n    override_price: number | null; // NOVO CAMPO\n    \n    client_id: ProfileData[] | null; \n    service_id: ServiceData[] | null; \n};\n\ntype SummaryStat = {\n  label: string;\n  value: string;\n  icon: React.ElementType;\n};\n\n// --- Dados Mockados (adaptados) ---\nconst mockUser = {\n  name: \"Dona Maria\",\n  avatarUrl: \"https://placehold.co/100x100/E62E7A/FFFFFF?text=M\"\n};\n\n\n// --- Componente: Header (Ajustado para usar o Bell Component) ---\nfunction Header({ user, manicureId }: { user: { name: string, avatarUrl: string }, manicureId: string | null }) {\n  const router = useRouter();\n  const [menuOpen, setMenuOpen] = useState(false);\n  const [manicureName, setManicureName] = useState(user.name);\n\n  const handleSignOut = async () => {\n    const { error } = await supabase.auth.signOut();\n    if (!error) {\n      router.replace('/'); \n    }\n  };\n\n  useEffect(() => {\n    async function loadProfile() {\n      const { data: { user: authUser } } = await supabase.auth.getUser();\n      if (!authUser) return;\n      \n      const { data: profile } = await supabase\n        .from('profiles')\n        .select('name')\n        .eq('id', authUser.id)\n        .single();\n      \n      if (profile) {\n        setManicureName(profile.name);\n      }\n    }\n    loadProfile();\n  }, []);\n  \n  const isActive = (path: string) => typeof window !== 'undefined' && window.location.pathname === path;\n\n\n  return (\n    <header className=\"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between items-center h-16\">\n          <div className=\"flex items-center space-x-8\">\n            <h1 className=\"text-2xl font-bold text-mani-pink-600\">ManiHelp</h1>\n            <nav className=\"hidden md:flex space-x-6\">\n              <a href=\"/dashboard\" \n                 className={`font-medium px-1 py-2 text-sm transition ${isActive('/dashboard') ? 'text-mani-pink-600 border-b-2 border-mani-pink-600' : 'text-gray-500 hover:text-gray-700'}`}>\n                <Calendar className=\"inline-block w-5 h-5 mr-1\" />\n                Agenda\n              </a>\n              <a href=\"/clients\" \n                 className={`font-medium px-1 py-2 text-sm transition ${isActive('/clients') ? 'text-mani-pink-600 border-b-2 border-mani-pink-600' : 'text-gray-500 hover:text-gray-700'}`}>\n                <Users className=\"inline-block w-5 h-5 mr-1\" />\n                Clientes\n              </a>\n              <a href=\"/services\" \n                 className={`font-medium px-1 py-2 text-sm transition ${isActive('/services') ? 'text-mani-pink-600 border-b-2 border-mani-pink-600' : 'text-gray-500 hover:text-gray-700'}`}>\n                <Briefcase className=\"inline-block w-5 h-5 mr-1\" />\n                Serviços\n              </a>\n              <a href=\"/schedules\" \n                 className={`font-medium px-1 py-2 text-sm transition ${isActive('/schedules') ? 'text-mani-pink-600 border-b-2 border-mani-pink-600' : 'text-gray-500 hover:text-gray-700'}`}>\n                <Clock className=\"inline-block w-5 h-5 mr-1\" />\n                Horários\n              </a>\n              <a href=\"#\" \n                 className={`font-medium px-1 py-2 text-sm transition text-gray-400 cursor-not-allowed`}\n                 title=\"Recurso em desenvolvimento\"\n              >\n                <BarChart3 className=\"inline-block w-5 h-5 mr-1\" />\n                <Lock className=\"inline-block w-4 h-4 mr-1\" /> \n                Relatórios\n              </a>\n            </nav>\n          </div>\n\n          <div className=\"flex items-center space-x-4\">\n            {/* COMPONENTE BELL ATIVO */}\n            {manicureId && <NotificationBell manicureId={manicureId} />} \n\n            <div className=\"relative\">\n              <button onClick={() => setMenuOpen(!menuOpen)} className=\"flex items-center space-x-2 rounded-full p-1 pr-2 hover:bg-gray-100\">\n                <img \n                  className=\"w-8 h-8 rounded-full object-cover\" \n                  src={user.avatarUrl}\n                  onError={(e) => { e.currentTarget.onerror = null; e.currentTarget.src=\"https://placehold.co/100x100/E62E7A/FFFFFF?text=M\"; }}\n                />\n                <span className=\"hidden sm:inline font-medium text-sm text-gray-700\">{manicureName}</span>\n                <ChevronDown className={`w-4 h-4 text-gray-500 transition-transform ${menuOpen ? 'rotate-180' : ''}`} />\n              </button>\n\n              {menuOpen && (\n                <div className=\"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl py-1 ring-1 ring-black ring-opacity-5 z-20\">\n                  <a href=\"#\" className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\">\n                    <Settings className=\"inline-block w-4 h-4 mr-2\" />\n                    Configurações\n                  </a>\n                  <button onClick={handleSignOut} className=\"w-full text-left block px-4 py-2 text-sm text-red-600 hover:bg-red-50\">\n                    <LogOut className=\"inline-block w-4 h-4 mr-2\" />\n                    Sair\n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </header>\n  );\n}\n\n\n// --- Funções Auxiliares de Dados (Atualizadas) ---\nconst getClientName = (appt: AppointmentItem) => appt.client_id ? appt.client_id[0]?.name : appt.guest_name || 'Cliente (Convidado)';\nconst getServiceName = (appt: AppointmentItem) => appt.service_id && appt.service_id[0] ? appt.service_id[0].name : 'Serviço Removido';\n// CORREÇÃO: Função que checa o preço customizado (override)\nconst getPrice = (appt: AppointmentItem) => {\n    // 1. Se override_price existir, use-o.\n    if (appt.override_price !== null) {\n        return appt.override_price;\n    }\n    // 2. Senão, use o preço do serviço.\n    if (appt.service_id && appt.service_id[0]) {\n        return appt.service_id[0].price;\n    }\n    // 3. Senão, 0.\n    return 0;\n};\n\n\n// --- Componente: UpcomingAppointments (Agendamentos de Hoje) ---\nfunction UpcomingAppointments({ appointments, isLoading, error, onShowDetails }: { \n    appointments: AppointmentItem[], \n    isLoading: boolean, \n    error: string | null,\n    onShowDetails: (appt: AppointmentItem) => void \n}) {\n\n  if (isLoading) {\n    return (\n      <div className=\"bg-white rounded-xl shadow-lg p-10 flex flex-col items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 text-mani-pink-600 animate-spin\" />\n        <p className=\"mt-4 text-gray-600\">Carregando agendamentos...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-xl shadow-lg\" role=\"alert\">\n        <p className=\"font-bold\">Erro de Conexão</p>\n        <p>Não foi possível carregar os agendamentos. Detalhes: {error}</p>\n      </div>\n    );\n  }\n  \n  const todayAppointments = appointments.filter(appt => appt.status !== 'cancelled' && appt.status !== 'pending');\n\n  if (todayAppointments.length === 0) {\n    return (\n      <div className=\"bg-white rounded-xl shadow-lg p-10 text-center\">\n        <CalendarCheck className=\"w-12 h-12 text-gray-400 mx-auto\" />\n        <h3 className=\"mt-4 text-xl font-semibold text-gray-900\">Nenhum Agendamento Hoje</h3>\n        <p className=\"mt-1 text-gray-500\">Seu dia está livre, ou talvez você deva criar um novo agendamento!</p>\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"bg-white rounded-xl shadow-lg overflow-hidden\">\n      <div className=\"p-6 border-b border-gray-200\">\n        <h2 className=\"text-xl font-semibold text-gray-800\">Próximos Agendamentos de Hoje ({todayAppointments.length})</h2>\n        <p className=\"text-sm text-gray-500 mt-1\">Compromissos confirmados para as próximas horas.</p>\n      </div>\n\n      <ul className=\"divide-y divide-gray-200\">\n        {todayAppointments.map((appt) => {\n            const time = new Date(appt.start_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n            const isConfirmed = appt.status === 'confirmed' || appt.status === 'completed';\n            \n            return (\n            <li key={appt.id} className=\"p-4 sm:p-6 flex flex-col sm:flex-row items-start sm:items-center justify-between hover:bg-gray-50 transition-colors\">\n                <div className=\"flex items-start space-x-4\">\n                <div className=\"flex-shrink-0 w-10 h-10 sm:w-12 sm:h-12 bg-mani-pink-100 text-mani-pink-600 rounded-full flex items-center justify-center font-bold text-base sm:text-lg\">\n                    {time.split(':')[0]}h\n                </div>\n                <div>\n                    <p className=\"text-md font-semibold text-gray-900\">{getClientName(appt)}</p>\n                    <p className=\"text-sm text-gray-600\">{getServiceName(appt)}</p>\n                </div>\n                </div>\n                \n                <div className=\"mt-3 sm:mt-0 flex items-center space-x-3\">\n                {isConfirmed ? (\n                    <span className=\"flex items-center text-xs font-medium text-green-600 bg-green-100 px-3 py-1 rounded-full\">\n                    <Check className=\"w-3 h-3 mr-1\" />\n                    Confirmado\n                    </span>\n                ) : (\n                    <span className=\"flex items-center text-xs font-medium text-yellow-600 bg-yellow-100 px-3 py-1 rounded-full\">\n                    <Clock className=\"w-3 h-3 mr-1\" />\n                    Pendente\n                    </span>\n                )}\n                <button \n                    onClick={() => onShowDetails(appt)} \n                    className=\"text-sm font-medium text-mani-pink-600 hover:text-mani-pink-800\"\n                >\n                    Detalhes\n                </button>\n                </div>\n            </li>\n        )})}\n      </ul>\n\n      <div className=\"p-6 bg-gray-50 text-center\">\n         <a href=\"#\" className=\"text-sm font-medium text-mani-pink-600 hover:text-mani-pink-800\">\n            Ver agenda completa\n          </a>\n      </div>\n    </div>\n  );\n}\n\n\n// --- Componente: PendingAppointmentsCard (Novo) ---\nfunction PendingAppointmentsCard({ appointments, onConfirm, isConfirming, onShowDetails }: { \n    appointments: AppointmentItem[], \n    onConfirm: (id: number) => void, \n    isConfirming: number | null,\n    onShowDetails: (appt: AppointmentItem) => void\n}) {\n    \n    const getClientName = (appt: AppointmentItem) => appt.client_id && appt.client_id[0] ? appt.client_id[0].name : appt.guest_name || 'Cliente (Convidado)';\n    const getServiceName = (appt: AppointmentItem) => appt.service_id && appt.service_id[0] ? appt.service_id[0].name : 'Serviço Removido';\n\n    // Filtra agendamentos PENDENTES E FUTUROS\n    const pendingAppointments = appointments.filter(appt => {\n        const isFuture = new Date(appt.start_time) > new Date();\n        return appt.status === 'pending' && isFuture;\n    });\n\n    if (pendingAppointments.length === 0) {\n        return null;\n    }\n    \n    return (\n        <div className=\"bg-white rounded-xl shadow-lg overflow-hidden mt-8\">\n            <div className=\"p-6 border-b border-yellow-200 bg-yellow-50\">\n                <h2 className=\"text-xl font-semibold text-gray-800 flex items-center\">\n                    <AlertTriangle className=\"w-6 h-6 mr-2 text-yellow-600\" />\n                    Aprovar Agendamentos ({pendingAppointments.length})\n                </h2>\n                <p className=\"text-sm text-gray-600 mt-1\">Requisições de serviço pendentes de sua confirmação.</p>\n            </div>\n            \n            <ul className=\"divide-y divide-gray-200\">\n                {pendingAppointments.map((appt) => {\n                    const time = new Date(appt.start_time).toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n                    const date = new Date(appt.start_time).toLocaleDateString('pt-BR');\n                    const isBusy = isConfirming === appt.id;\n\n                    return (\n                        <li key={appt.id} className=\"p-4 sm:p-6 flex flex-col sm:flex-row items-start sm:items-center justify-between hover:bg-yellow-50 transition-colors\">\n                            \n                            {/* Informações */}\n                            <div className=\"flex-1 space-y-1 sm:space-y-0 sm:flex sm:items-center sm:space-x-4\">\n                                <div className=\"text-sm font-semibold text-gray-900\">\n                                    {date} às {time}\n                                </div>\n                                <div>\n                                    <p className=\"text-md font-semibold text-gray-900\">{getClientName(appt)}</p>\n                                    <p className=\"text-sm text-gray-600\">{getServiceName(appt)}</p>\n                                </div>\n                            </div>\n                            \n                            {/* Ações */}\n                            <div className=\"mt-3 sm:mt-0 flex items-center space-x-3\">\n                                <button \n                                    onClick={() => onShowDetails(appt)} \n                                    disabled={isBusy}\n                                    className=\"px-3 py-2 text-sm font-medium text-mani-pink-600 hover:text-mani-pink-800 transition rounded-lg hover:bg-mani-pink-50\"\n                                >\n                                    <Info className=\"w-4 h-4\" />\n                                </button>\n                                \n                                <button \n                                    onClick={() => onConfirm(appt.id)}\n                                    disabled={isBusy}\n                                    className=\"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg shadow-md hover:bg-green-700 transition flex items-center justify-center disabled:opacity-50\"\n                                >\n                                    {isBusy ? (\n                                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                                    ) : (\n                                        <>\n                                            <ClipboardCheck className=\"w-4 h-4 mr-2\" />\n                                            Confirmar\n                                        </>\n                                    )}\n                                </button>\n                            </div>\n                        </li>\n                    );\n                })}\n            </ul>\n        </div>\n    );\n}\n\n\n// --- Componente: SummaryCard ---\nfunction SummaryCard({ stats }: { stats: SummaryStat[] }) {\n  const statIcons: { [key: string]: React.ElementType } = {\n    'Agendamentos Hoje': Calendar,\n    'Requisições Pendentes': AlertTriangle,\n    'Receita Estimada (Hoje)': DollarSign,\n  };\n\n  return (\n    <div className=\"bg-white rounded-xl shadow-lg p-6\">\n      <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Resumo do Dia</h3>\n      <div className=\"space-y-4\">\n        {stats.map((stat) => {\n          const Icon = statIcons[stat.label] || AlertTriangle;\n          return (\n            <div key={stat.label} className=\"flex justify-between items-center border-b border-gray-100 pb-2 last:border-b-0 last:pb-0\">\n              <div className=\"flex items-center\">\n                <Icon className=\"w-4 h-4 mr-2 text-mani-pink-500\" />\n                <p className=\"text-sm font-medium text-gray-600\">{stat.label}</p>\n              </div>\n              <p className=\"text-xl font-bold text-gray-900\">{stat.value}</p>\n            </div>\n          )\n        })}\n      </div>\n    </div>\n  );\n}\n\n\n// --- Componente Principal: DashboardPage ---\nexport default function DashboardPage() {\n  const router = useRouter(); \n  const [allAppointments, setAllAppointments] = useState<AppointmentItem[]>([]); \n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [manicureId, setManicureId] = useState<string | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [isConfirming, setIsConfirming] = useState<number | null>(null); \n  const [selectedAppointment, setSelectedAppointment] = useState<AppointmentItem | null>(null);\n\n  // Função para confirmar um agendamento\n  const handleConfirm = async (id: number) => {\n    setIsConfirming(id);\n    try {\n        const { error: updateError } = await supabase\n            .from('appointments')\n            .update({ status: 'confirmed' })\n            .eq('id', id);\n\n        if (updateError) {\n            throw new Error(updateError.message);\n        }\n    } catch (e: any) {\n        console.error(\"Erro ao confirmar agendamento:\", e);\n        alert(`Falha ao confirmar. Detalhes: ${e.message}`);\n    } finally {\n        setIsConfirming(null);\n    }\n  };\n\n\n  // Filtra agendamentos que são HOJE\n  const isToday = (dateString: string) => {\n    const today = new Date();\n    const date = new Date(dateString);\n    return date.toDateString() === today.toDateString();\n  };\n  \n  // Função que busca TODOS os agendamentos (Hoje + Pendentes + Futuros)\n  const fetchAppointments = useCallback(async () => {\n    // setIsLoading(true); // Não seta para evitar o \"piscar\" no Realtime\n    setError(null);\n    if (!manicureId) return; \n\n    try {\n      const yesterday = new Date();\n      yesterday.setDate(yesterday.getDate() - 1);\n      \n      // CORREÇÃO: Adicionado 'override_price' e 'notes' ao select\n      const { data, error } = await supabase\n        .from('appointments')\n        .select(`\n          id, start_time, end_time, status,\n          guest_name, guest_phone, notes, override_price, \n          client_id (id, name, phone_number),\n          service_id (id, name, price)\n        `)\n        .eq('manicure_id', manicureId)\n        .gte('start_time', yesterday.toISOString()) \n        .order('start_time', { ascending: true }); \n\n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      setAllAppointments(data as AppointmentItem[]);\n\n    } catch (e: any) {\n      console.error('Erro ao buscar agendamentos:', e);\n      setError(`Falha ao buscar dados: ${e.message}`);\n    } finally {\n      setIsLoading(false); \n    }\n  }, [manicureId]);\n\n\n  // 1. CARREGAMENTO E AUTORIZAÇÃO\n  useEffect(() => {\n    async function checkAuthAndRole() {\n      setIsLoading(true); \n      const { data: { user } } = await supabase.auth.getUser();\n      \n      if (!user) {\n        router.replace('/'); \n        return;\n      }\n      \n      const { data: profile, error } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single();\n      \n      if (error || profile?.role !== 'manicure') {\n        await supabase.auth.signOut();\n        router.replace('/');\n        return;\n      }\n\n      setManicureId(user.id);\n    }\n    checkAuthAndRole();\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((event) => {\n      if (event === 'SIGNED_OUT') {\n        router.replace('/');\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, [router]);\n\n\n  // 2. REALTIME (Sem Polling)\n  useEffect(() => {\n    if (manicureId) {\n      fetchAppointments();\n      \n      const channel = supabase\n        .channel(`dashboard_appointments_${manicureId}`)\n        .on(\n            'postgres_changes',\n            { \n              event: '*', \n              schema: 'public', \n              table: 'appointments', \n              filter: `manicure_id=eq.${manicureId}` \n            },\n            () => {\n                fetchAppointments();\n            }\n        )\n        .subscribe();\n        \n      return () => {\n          supabase.removeChannel(channel);\n      };\n    }\n  }, [manicureId, fetchAppointments]); \n\n  \n  // 3. Divisão dos Agendamentos\n  const todayAppointments = allAppointments.filter(appt => isToday(appt.start_time));\n  const pendingAppointments = allAppointments.filter(appt => appt.status === 'pending');\n  \n\n  // 4. Calcular Estatísticas do Resumo do Dia\n  const todayRevenue = todayAppointments.reduce((sum, appt) => {\n    if (appt.status === 'completed' || appt.status === 'confirmed') {\n      // CORREÇÃO: Usa a função getPrice\n      return sum + getPrice(appt);\n    }\n    return sum;\n  }, 0);\n\n  const summaryStats: SummaryStat[] = [\n    { label: \"Agendamentos Hoje\", value: todayAppointments.length.toString(), icon: Calendar },\n    { label: \"Requisições Pendentes\", value: pendingAppointments.length.toString(), icon: AlertTriangle },\n    { label: \"Receita Estimada (Hoje)\", value: `R$ ${todayRevenue.toFixed(2)}`, icon: DollarSign },\n  ];\n  \n  // Função para re-fetch quando um novo agendamento for criado\n  const handleAppointmentCreated = () => {\n    setIsModalOpen(false); \n    fetchAppointments(); // Força a atualização imediata\n  };\n  \n  // Exibir loader enquanto o estado de auth e role não é definido\n  if (!manicureId && !error && isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n        <Loader2 className=\"w-8 h-8 text-mani-pink-600 animate-spin\" />\n        <p className=\"ml-3 text-gray-600\">Verificando autenticação...</p>\n      </div>\n    );\n  }\n\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 font-inter\">\n      <Header user={mockUser} manicureId={manicureId} />\n\n      <main className=\"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8\">\n        \n        <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">\n              Bem-vinda de volta, Dona Maria!\n            </h1>\n            <p className=\"lg:text-lg text-gray-600 mt-1\">\n              Você tem {todayAppointments.length} agendamentos confirmados para hoje.\n            </p>\n          </div>\n          <button \n            onClick={() => setIsModalOpen(true)}\n            className=\"mt-4 md:mt-0 flex items-center justify-center bg-mani-pink-600 text-white px-5 py-3 rounded-lg shadow-md hover:bg-mani-pink-700 transition-all duration-300 transform hover:scale-105\"\n          >\n            <Plus className=\"w-5 h-5 mr-2\" />\n            Novo Agendamento\n          </button>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          \n          <div className=\"lg:col-span-2 space-y-8\">\n            \n            {/* CARD 1: AGENDAMENTOS DE HOJE */}\n            <UpcomingAppointments \n                appointments={todayAppointments} \n                isLoading={isLoading} \n                error={error} \n                onShowDetails={setSelectedAppointment} \n            />\n            \n            {/* CARD 2: AGENDAMENTOS PENDENTES (NOVO) */}\n            <PendingAppointmentsCard \n                appointments={allAppointments} \n                onConfirm={handleConfirm} \n                isConfirming={isConfirming} \n                onShowDetails={setSelectedAppointment} \n            />\n\n          </div>\n\n          <div className=\"lg:col-span-1 space-y-8\">\n            <SummaryCard stats={summaryStats} />\n          </div>\n        </div>\n      </main>\n      \n      {/* Modal de Novo Agendamento */}\n      {manicureId && (\n        <NewAppointmentModal \n          isOpen={isModalOpen} \n          onClose={() => setIsModalOpen(false)} \n          manicureId={manicureId}\n          onAppointmentCreated={handleAppointmentCreated}\n        />\n      )}\n      \n      {/* Modal de Detalhes (Renderizado aqui) */}\n      <AppointmentDetailModal \n        appointment={selectedAppointment} \n        onClose={() => setSelectedAppointment(null)} \n        onUpdate={fetchAppointments} // Passa a função de re-fetch\n      />\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}